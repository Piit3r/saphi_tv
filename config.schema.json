{
  "pluginAlias": "SaphiTV",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "type": "string",
        "required": true,
        "default": "Saphi TV"
      },
      "ip_adress": {
        "type": "string",
        "required": true
      },
      "wol_adress": {
        "type": "string",
        "required": true
      },
      "startup_time": {
        "type": "integer",
        "minimum": 10,
        "maximum": 30,
        "required": true,
        "default": 10
      },
      "timeout": {
        "type": "integer",
        "minimum": 2,
        "maximum": 15,
        "required": true,
        "default": 5
      },
      "input_delay": {
        "type": "integer",
        "minimum": 150,
        "maximum": 1500,
        "required": true,
        "default": 600
      },
      "polling_interval": {
        "type": "integer",
        "minimum": 15,
        "maximum": 120,
        "required": true,
        "default": 30
      },
      "has_ambilight": {
        "type": "boolean",
        "required": true,
        "default": true
      },
      "has_ambihue": {
        "type": "boolean",
        "required": true,
        "default": true,
        "condition": {
          "functionBody": "return model.has_ambilight === true;"
        }
      },
      "ambi_poweroff": {
        "type": "boolean",
        "required": true,
        "default": true,
        "condition": {
          "functionBody": "return (model.has_ambilight === true && model.has_ambihue === true);"
        }
      },
      "ambi_poweron": {
        "type": "boolean",
        "required": true,
        "default": false,
        "condition": {
          "functionBody": "return (model.has_ambilight === true && model.has_ambihue === true);"
        }
      },
      "inputs": {
        "type": "array",
        "items": {
          "title": "Input",
          "type": "object",
          "properties": {
            "name": {
              "title": "Name",
              "type": "string",
              "placeholder": "Input Name",
              "required": true
            },
            "type": {
              "title": "Type",
              "type": "string",
              "oneOf": [
                {
                  "title": "TV",
                  "enum": [
                    "TV"
                  ]
                },
                {
                  "title": "App",
                  "enum": [
                    "APP"
                  ]
                },
                {
                  "title": "Source",
                  "enum": [
                    "SOURCE"
                  ]
                },
                {
                  "title": "Channel",
                  "enum": [
                    "CHANNEL"
                  ]
                }
              ],
              "required": true,
              "default": "TV"
            },
            "position": {
              "title": "Position",
              "type": "number",
              "placeholder": "1",
              "required": true,
              "condition": {
                "functionBody": "return model.inputs[arrayIndices].type !== 'TV';"
              }
            }
          }
        }
      }
    }
  },
  "layout": [
    {
      "key": "name",
      "title": "Name",
      "placeholder": "TV Name",
      "description": "How you want to Name your TV",
      "notitle": false
    },
    {
      "type": "fieldset",
      "title": "Local Network",
      "expandable": true,
      "expanded": true,
      "items": [
        {
          "type": "flex",
          "flex-flow": "row",
          "items": [
            {
              "title": "IP Adress",
              "key": "ip_adress",
              "description": "IP adress of your TV",
              "notitle": false
            },
            {
              "title": "WOL Adress",
              "key": "wol_adress",
              "notitle": false,
              "placeholder": "wol://20:DE:20:DE:20:DE",
              "description": "WOL adress of your TV (mac-adress)"
            }
          ]
        }
      ]
    },
    {
      "type": "fieldset",
      "title": "Capabilities",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "type": "flex",
          "flex-flow": "column",
          "items": [
            {
              "key": "has_ambilight",
              "title": "TV has Ambilight",
              "description": "Checking this will allow you to control your TVs Ambilight",
              "notitle": false
            },
            {
              "key": "has_ambihue",
              "title": "Ambilight + Hue support",
              "description": "Checking this will add a switch to your TV to control the Ambilight+Hue option.",
              "notitle": false
            },
            {
              "key": "ambi_poweron",
              "notitle": false,
              "title": "automatically turn on Ambilight when turning on TV",
              "description": "This will turn on Ambilight+Hue when you start the TV with the home app"
            },
            {
              "key": "ambi_poweroff",
              "notitle": false,
              "title": "Turn off Ambilight+ before turning off the TV",
              "description": "This will turn off Ambilight+Hue before turning off your TV as a workaround for a know Ambilight+Hue bug where you would get a significant delay"
            }
          ]
        }
      ]
    },
    {
      "type": "fieldset",
      "title": "Timings",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "type": "flex",
          "flex-flow": "column",
          "items": [
            {
              "key": "startup_time",
              "notitle": false,
              "description": "Approximate time your TV takes to start.",
              "title": "Startup time"
            },
            {
              "key": "input_delay",
              "title": "Delay between inputs (ms)",
              "description": "This changes how long the plugin waits between 'key-presses' when commanding your TV. Lower values make it feel more snappy but if it's too low, your TV might not be fast enough or shut down it's API.",
              "notitle": false
            },
            {
              "key": "polling_interval",

        "title": "Polling Interval (s)",
        "description": "How often the TV state is updated in the background",
              "notitle": false
            },
            {
              "title": "Timeout time",
              "description": "This changes how long the plugin waits for answers from your tv. Higher values give your TV more time to respond in case of a bad connection but if it's too high, homekit might return early with a 'No Respone'.",
              "key": "timeout",
              "notitle": false
            }
          ]
        }
      ]
    },
    {
      "type": "fieldset",
      "title": "Inputs",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "description": "This allows you to add 'inputs' to your TV. TV only sends the 'Watch TV' key. Channel will send the 'Watch TV' key and then input the channel you specified. App will open an App from your 'home' bar (e.g. Netflix). Source will select one of your input sources (e.g. HDMI1). Appmode: the position of your app relative to the cursor position when you open the 'home' bar (negative numbers go left, positive numbers go right, 0 immediately confirms). Sourcemode: the position of your app relative to the cursor position when you open the 'sources' bar (negative numbers go left, positive numbers go right, 0 immediately confirms).  Channelmode: the Channel you want to watch. ",
          "key": "inputs",
          "title": "Input",
          "notitle": true,
          "type": "array",
          "items": [
            {
              "type": "div",
              "displayFlex": true,
              "flex-direction": "row",
              "items": [
                {
                  "key": "inputs[].type",
                  "flex": "1 1 50px",
                  "notitle": false,
                  "placeholder": "Position"
                },
                {
                  "key": "inputs[].name",
                  "flex": "2 2 200px",
                  "notitle": false,
                  "placeholder": "Name"
                },
                {
                  "key": "inputs[].position",
                  "flex": "1 1 50px",
                  "notitle": false,
                  "placeholder": "Type"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}